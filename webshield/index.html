<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WebShield | Documentation</title>
    <meta name="description" content="Imunify360 documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.911dbde5.css" as="style"><link rel="preload" href="/assets/js/app.bb2f7be1.js" as="script"><link rel="preload" href="/assets/js/35.0ca91d25.js" as="script"><link rel="prefetch" href="/assets/js/10.bca94a56.js"><link rel="prefetch" href="/assets/js/11.1ac28269.js"><link rel="prefetch" href="/assets/js/12.6e226521.js"><link rel="prefetch" href="/assets/js/13.46ffe73a.js"><link rel="prefetch" href="/assets/js/14.8af932ce.js"><link rel="prefetch" href="/assets/js/15.be808a2e.js"><link rel="prefetch" href="/assets/js/16.d5374f4e.js"><link rel="prefetch" href="/assets/js/17.7f7dd8b2.js"><link rel="prefetch" href="/assets/js/18.2df70bc1.js"><link rel="prefetch" href="/assets/js/19.ac9bbcb3.js"><link rel="prefetch" href="/assets/js/20.a1f5b6d2.js"><link rel="prefetch" href="/assets/js/21.f96a9d22.js"><link rel="prefetch" href="/assets/js/22.29c32b96.js"><link rel="prefetch" href="/assets/js/23.20091f94.js"><link rel="prefetch" href="/assets/js/24.c7b1bafd.js"><link rel="prefetch" href="/assets/js/25.8d2071a2.js"><link rel="prefetch" href="/assets/js/26.b355be66.js"><link rel="prefetch" href="/assets/js/27.cab9d609.js"><link rel="prefetch" href="/assets/js/28.e992504f.js"><link rel="prefetch" href="/assets/js/29.5c0203f8.js"><link rel="prefetch" href="/assets/js/3.583977e2.js"><link rel="prefetch" href="/assets/js/30.3c699a2e.js"><link rel="prefetch" href="/assets/js/31.46e3c68b.js"><link rel="prefetch" href="/assets/js/32.7645454a.js"><link rel="prefetch" href="/assets/js/33.22054825.js"><link rel="prefetch" href="/assets/js/34.edeb6609.js"><link rel="prefetch" href="/assets/js/36.ea707de3.js"><link rel="prefetch" href="/assets/js/37.cceb7d7a.js"><link rel="prefetch" href="/assets/js/4.da556001.js"><link rel="prefetch" href="/assets/js/5.8eedbc81.js"><link rel="prefetch" href="/assets/js/6.9781c443.js"><link rel="prefetch" href="/assets/js/7.65392d0f.js"><link rel="prefetch" href="/assets/js/8.3f6008df.js"><link rel="prefetch" href="/assets/js/9.2d72e62d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.a71a1da2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.911dbde5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webshield/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/webshield/" class="nav-link">Русский</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webshield/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/webshield/" class="nav-link">Русский</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><a href="/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/terminology/" class="sidebar-link">Terminology</a></li><li><a href="/billing/" class="sidebar-link">Billing</a></li><li><a href="/installation/" class="sidebar-link">Installation Guide</a></li><li><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></li><li><a href="/webshield/" class="active sidebar-link">WebShield</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webshield/#captcha" class="sidebar-link">Captcha</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webshield/#captcha-page-customization" class="sidebar-link">Captcha page customization</a></li><li class="sidebar-sub-header"><a href="/webshield/#update-captcha-localizations" class="sidebar-link">Update Captcha localizations</a></li></ul></li><li class="sidebar-sub-header"><a href="/webshield/#cdn-support-3-8" class="sidebar-link">CDN Support</a></li></ul></li><li><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></li><li><a href="/localization/" class="sidebar-link">Localization</a></li><li><a href="/dashboard/" class="sidebar-link">Imunify360 User Interface</a></li><li><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulesets Specific Settings</a></li><li><a href="/config_file_description/" class="sidebar-link">Config File Description</a></li><li><a href="/command_line_interface/" class="sidebar-link">Command-line Interface</a></li><li><a href="/uninstall/" class="sidebar-link">Uninstall</a></li><li><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></li><li><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/webshield/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    WebShield
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/ids_integration/" class="link prev">
      ←
    </a> <a href="/backup_providers_integration/" class="link">
      →
    </a></div></div> <div class="content"><h1 id="webshield"><a href="#webshield" aria-hidden="true" class="header-anchor">#</a> WebShield</h1> <h2 id="captcha"><a href="#captcha" aria-hidden="true" class="header-anchor">#</a> Captcha</h2> <p>The CAPTCHA is a feature intended to distinguish human from machine input and protect websites from the spam and different types of automated abuse. Imunify360 uses <a href="https://www.google.com/recaptcha/intro/invisible.html" target="_blank" rel="noopener noreferrer">reCAPTCHA<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> service.</p> <p>There are two layers in CAPTCHA behavior:</p> <ol><li>If a user of a website is added to the <span class="notranslate">Grey List</span> (the access is blocked), then the CAPTCHA allows him to unblock himself. When he tries to get to the website he is redirected to the Captcha Server by ipset, where he can see the protection page asking to confirm that he is not a robot by ticking a checkbox.</li></ol> <p><img src="/images/captcha.jpg" alt></p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>The IP address on the screenshot above is given as an example.</p></div> <p>If successful, a user is redirected to the website, which means that the access is unblocked and the IP address of this user is removed from the <span class="notranslate">Grey List</span>.</p> <p>It is also possible to enable the invisible reCAPTCHA via the Imunify360 <a href="/dashboard/#settings"><span class="notranslate">Settings</span> page</a>. With the invisible reCAPTCHA enabled, a human user is not required to go through human confirmation - the process will pass under the hood and a user will be redirected to the website. In case if invisible reCAPTCHA failed to detect if a user is a human or not, then visible reCAPTCHA appears.</p> <ol start="2"><li>The CAPTCHA is always on guard of the websites and checks the activity of each IP. With the help of reCAPTCHA it blocks bots and protects websites from spam and abuse. To learn more about reCAPTCHA follow the <a href="https://www.google.com/recaptcha/intro/" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ol> <p>The reCaptcha supports localization. Depending on user’s browser settings, reCaptcha will use the browser default language and allow to change it:</p> <p><img src="/images/local.jpg" alt></p> <h3 id="captcha-page-customization"><a href="#captcha-page-customization" aria-hidden="true" class="header-anchor">#</a> Captcha page customization</h3> <p>To modify footer, header or body of the CAPTCHA use the templates in <span class="notranslate"><code>/usr/share/imunify360-webshield/captcha/templates/</code></span>.</p> <p>There are three files:</p> <ul><li><p><span class="notranslate"><code>head.tpl</code></span> – this file goes inside <span class="notranslate"><code>&lt;head&gt;&lt;/head&gt;</code></span> tags. So you can add JavaScript, CSS styles, etc.</p></li> <li><p><span class="notranslate"><code>body.tpl</code></span> – the main template file, modify it as you wish. CAPTCHA goes above all the layers.</p></li> <li><p><span class="notranslate"><code>static</code></span> – here you can place images, CSS, JavaScript, etc. and access these files as <span class="notranslate"><code>/static/&lt;filename&gt;</code></span>.</p></li></ul> <p>To find information on supported browsers follow this link <a href="https://support.google.com/recaptcha/answer/6223828" target="_blank" rel="noopener noreferrer">https://support.google.com/recaptcha/answer/6223828<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="update-captcha-localizations"><a href="#update-captcha-localizations" aria-hidden="true" class="header-anchor">#</a> Update Captcha localizations</h3> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Custom Captcha localization is available starting from Imunify360 version 2.6.0 and later.</p></div> <p>A user can change the text of captcha messages for the supported languages. Note that adding custom language is not supported.</p> <p>To change the text of the Imunify360 Captcha and update the localizations text, please do the following:</p> <ol><li><p>Locate appropriate Captcha localization files by running:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>ls /usr/share/imunify360-webshield/captcha/translations/locale/{lang}/LC_MESSAGES/messages.po
</code></pre></div></div>
For example for Polish language the catalog looks like this: 
 <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/usr/share/imunify360-webshield/captcha/translations/locale/pl/LC_MESSAGES/messages.po
</code></pre></div></div></li> <li><p>Update Captcha localization files by editing <span class="notranslate"><code>msgstr &quot;my customization or translation&quot;</code></span> for appropriate <span class="notranslate"><code>msgid “original plain english text&quot;</code></span>.</p> <p>Where <span class="notranslate"><code>msgstr</code></span> contains text that is shown to user and <span class="notranslate"><code>msgid</code></span> contains Captcha original English text.</p> <p>For example:</p> <div class="notranslate"><div class="language-HTML extra-class"><pre class="language-html"><code>#: templates/index.html:154
msgid &quot;&quot;
&quot;We have noticed an unusual activity from your <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>IP {client_ip}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> and &quot;
&quot;blocked access to this website.&quot;
msgstr &quot;&quot;
&quot;Zauważyliśmy nietypową aktywność związaną z twoim adresem <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>IP &quot;
&quot;{client_ip}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> i zablokowaliśmy dostęp do tej strony internetowej&quot;
</code></pre></div></div></li> <li><p>To add Polish translation edit text in the <span class="notranslate"><code>msgstr</code></span> field. To change the text for a default English translation, edit text in the <span class="notranslate"><code>msgid</code></span> field.</p></li> <li><p>Save files.</p></li> <li><p>When translation in <span class="notranslate"><code>messages.po</code></span> files is finished, restart <span class="notranslate">imunify360-webshield</span> service:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-webshield restart
</code></pre></div></div>
6. Block yourself (remove your IP from <span class="notranslate">Imunify360 White List</span> and try to log in to the server via ssh with wrong password until it blocks you). Then go to website and log in. Captcha should appear. Set Polish language and assert that new text is displayed.
<h2 id="cdn-support-3-8"><a href="#cdn-support-3-8" aria-hidden="true" class="header-anchor">#</a> CDN Support <sup>3.8+</sup></h2> <p>Starting from version 3.8 Imunify360 correctly graylists and blocks IPs behind Cloudflare and other CDNs (see <a href="/webshield/#supported-cdn-providers">here</a> for the full list).</p> <p>Imunify360 passes all requests from CDN through <span class="notranslate">WebShield</span>, and uses <span class="notranslate">CF-Connecting-IP</span> and <span class="notranslate">X-Forwarded-For</span> headers to identify real IPs.</p> <p>The feature is disabled by default in Imunify360 version 3.8 but will be enabled in the future versions.</p> <p>To enable it now, add the following section to the Imunify360 config file (<span class="notranslate"><em>/etc/sysconfig/imunify360/imunify360.config</em></span>):</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>WEBSHIELD:
 known_proxies_support: true
</code></pre></div></div>
And restart <span class="notranslate">WebShield</span>
For EL6:
<div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-webshield restart
</code></pre></div></div>
For other systems:
<div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl restart imunify360-webshield
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>If you are using cPanel/EasyApache3, Imunify360 will not automatically deploy <em>mod_remoteip</em>, and log files will show local server IP for visitors coming from CDN. EasyApache 3 is EOL in December 2018, and we don't plan to add automated <em>mod_remoteip</em> setup and configuration for it.</p></div> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>For cPanel/EasyApache 4, Plesk, DirectAdmin and LiteSpeed <em>mod_remoteip</em> will be automatically installed and configured.</p></div> <h4 id="supported-cdn-providers"><a href="#supported-cdn-providers" aria-hidden="true" class="header-anchor">#</a> Supported CDN providers:</h4> <ul><li>Cloudflare: December 2018</li> <li>MaxCDN: December 2018</li> <li>StackPath CDN: April 2019</li> <li>KeyCDN is not supported at the moment, ETA is not yet available.</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/webshield/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> </div> <div class="footer" data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.com" data-v-20b89de8><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-20b89de8></a></div> <div class="footer-company-title" data-v-20b89de8>2019. CloudLinux Inc</div> <div data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/sections/115001344329-How-do-I" target="_blank" data-v-20b89de8>How to</a></div><div data-v-20b89de8><a href="https://imunify360.com/getting-started" target="_blank" data-v-20b89de8>Getting started</a></div><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-20b89de8>Contact support</a></div><div data-v-20b89de8><a href="https://www.imunify360.com/blog" target="_blank" data-v-20b89de8>Blog</a></div></div> <div class="social" data-v-20b89de8><span class="footer-social-text" data-v-20b89de8>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-20b89de8><img src="/fb.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-20b89de8><img src="/tw.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-20b89de8><img src="/in.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-20b89de8><img src="/ytube.png" class="footer-social-logo" data-v-20b89de8></a></div></div> <!----></div></div>
    <script src="/assets/js/app.bb2f7be1.js" defer></script><script src="/assets/js/35.0ca91d25.js" defer></script>
  </body>
</html>
