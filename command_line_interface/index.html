<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Command-line Interface | Documentation</title>
    <meta name="description" content="Imunify360 documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.911dbde5.css" as="style"><link rel="preload" href="/assets/js/app.bb2f7be1.js" as="script"><link rel="preload" href="/assets/js/7.65392d0f.js" as="script"><link rel="prefetch" href="/assets/js/10.bca94a56.js"><link rel="prefetch" href="/assets/js/11.1ac28269.js"><link rel="prefetch" href="/assets/js/12.6e226521.js"><link rel="prefetch" href="/assets/js/13.46ffe73a.js"><link rel="prefetch" href="/assets/js/14.8af932ce.js"><link rel="prefetch" href="/assets/js/15.be808a2e.js"><link rel="prefetch" href="/assets/js/16.d5374f4e.js"><link rel="prefetch" href="/assets/js/17.7f7dd8b2.js"><link rel="prefetch" href="/assets/js/18.2df70bc1.js"><link rel="prefetch" href="/assets/js/19.ac9bbcb3.js"><link rel="prefetch" href="/assets/js/20.a1f5b6d2.js"><link rel="prefetch" href="/assets/js/21.f96a9d22.js"><link rel="prefetch" href="/assets/js/22.29c32b96.js"><link rel="prefetch" href="/assets/js/23.20091f94.js"><link rel="prefetch" href="/assets/js/24.c7b1bafd.js"><link rel="prefetch" href="/assets/js/25.8d2071a2.js"><link rel="prefetch" href="/assets/js/26.b355be66.js"><link rel="prefetch" href="/assets/js/27.cab9d609.js"><link rel="prefetch" href="/assets/js/28.e992504f.js"><link rel="prefetch" href="/assets/js/29.5c0203f8.js"><link rel="prefetch" href="/assets/js/3.583977e2.js"><link rel="prefetch" href="/assets/js/30.3c699a2e.js"><link rel="prefetch" href="/assets/js/31.46e3c68b.js"><link rel="prefetch" href="/assets/js/32.7645454a.js"><link rel="prefetch" href="/assets/js/33.22054825.js"><link rel="prefetch" href="/assets/js/34.edeb6609.js"><link rel="prefetch" href="/assets/js/35.0ca91d25.js"><link rel="prefetch" href="/assets/js/36.ea707de3.js"><link rel="prefetch" href="/assets/js/37.cceb7d7a.js"><link rel="prefetch" href="/assets/js/4.da556001.js"><link rel="prefetch" href="/assets/js/5.8eedbc81.js"><link rel="prefetch" href="/assets/js/6.9781c443.js"><link rel="prefetch" href="/assets/js/8.3f6008df.js"><link rel="prefetch" href="/assets/js/9.2d72e62d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.a71a1da2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.911dbde5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/command_line_interface/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/command_line_interface/" class="nav-link">Русский</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/command_line_interface/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/command_line_interface/" class="nav-link">Русский</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><a href="/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/terminology/" class="sidebar-link">Terminology</a></li><li><a href="/billing/" class="sidebar-link">Billing</a></li><li><a href="/installation/" class="sidebar-link">Installation Guide</a></li><li><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></li><li><a href="/webshield/" class="sidebar-link">WebShield</a></li><li><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></li><li><a href="/localization/" class="sidebar-link">Localization</a></li><li><a href="/dashboard/" class="sidebar-link">Imunify360 User Interface</a></li><li><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulesets Specific Settings</a></li><li><a href="/config_file_description/" class="sidebar-link">Config File Description</a></li><li><a href="/command_line_interface/" class="active sidebar-link">Command-line Interface</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/command_line_interface/#_3rdparty" class="sidebar-link">3rdparty</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#blacklist" class="sidebar-link">Blacklist</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#blocked-ports" class="sidebar-link">Blocked ports</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#check-domains" class="sidebar-link">Check-domains</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#clean" class="sidebar-link">Clean</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#checkdb" class="sidebar-link">Checkdb</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#doctor" class="sidebar-link">Doctor</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#features" class="sidebar-link">Features</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#get" class="sidebar-link">Get</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#graylist" class="sidebar-link">Graylist</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#import" class="sidebar-link">Import</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#infected-domains" class="sidebar-link">Infected-domains</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#malware" class="sidebar-link">Malware</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#migratedb" class="sidebar-link">Migratedb</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#plugins" class="sidebar-link">Plugins</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#register" class="sidebar-link">Register</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#rstatus" class="sidebar-link">Rstatus</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#rules" class="sidebar-link">Rules</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#unregister" class="sidebar-link">Unregister</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#vendors" class="sidebar-link">Vendors</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#version" class="sidebar-link">Version</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#submit-false-positive-false-negative" class="sidebar-link">Submit false-positive/false-negative</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#whitelist" class="sidebar-link">Whitelist</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#proactive" class="sidebar-link">Proactive</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#check-modsec-directives" class="sidebar-link">Check modsec directives</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#fix-modsec-directives" class="sidebar-link">Fix modsec directives</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#feature-management" class="sidebar-link">Feature-management</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#feature-management-native-enable" class="sidebar-link">Feature-management native enable</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#feature-management-native-disable" class="sidebar-link">Feature-management native disable</a></li></ul></li><li><a href="/uninstall/" class="sidebar-link">Uninstall</a></li><li><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></li><li><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/command_line_interface/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    Command-line Interface
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/config_file_description/" class="link prev">
      ←
    </a> <a href="/uninstall/" class="link">
      →
    </a></div></div> <div class="content"><h1 id="command-line-interface"><a href="#command-line-interface" aria-hidden="true" class="header-anchor">#</a> Command-line Interface</h1> <p>For access to Imunify360 agent features from command-line interface, use the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Returns the help message</td></tr> <tr><td><span class="notranslate"><code>--console-log-level [ERROR,WARNING,INFO,DEBUG]</code></span></td> <td>Level of logging input to the console</td></tr></tbody></table> <p>Basic usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent [command] [--option1] [--option2]...
</code></pre></div></div> <p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>3rdparty</code></span></td> <td>Make Imunify360 the primary IDS</td></tr> <tr><td><span class="notranslate"><code>blacklist</code></span></td> <td>Return/Edit IP blacklist</td></tr> <tr><td><span class="notranslate"><code>blocked-port</code></span></td> <td>Return/Edit list of blocked ports</td></tr> <tr><td><span class="notranslate"><code>check-domains</code></span></td> <td>Send domain list check</td></tr> <tr><td><span class="notranslate"><code>clean</code></span></td> <td>Clean the incidents</td></tr> <tr><td><span class="notranslate"><code>checkdb</code></span></td> <td>Check database integrity</td></tr> <tr><td><span class="notranslate"><code>doctor</code></span></td> <td>Collect info about system and send it to CloudLinux</td></tr> <tr><td><span class="notranslate"><code>features</code></span></td> <td>Manage available features for Imunify360</td></tr> <tr><td><span class="notranslate"><code>get</code></span></td> <td>Returns list of incidents</td></tr> <tr><td><span class="notranslate"><code>graylist</code></span></td> <td>Return/Edit IP <span class="notranslate">Gray List</span></td></tr> <tr><td><span class="notranslate"><code>import</code></span></td> <td>Import data</td></tr> <tr><td><span class="notranslate"><code>infected-domains</code></span></td> <td>Returns infected domain list</td></tr> <tr><td><span class="notranslate"><code>malware</code></span></td> <td>Allows to manage malware options</td></tr> <tr><td><span class="notranslate"><code>migratedb</code></span></td> <td>Check and repair database if it is corrupted</td></tr> <tr><td><span class="notranslate"><code>plugins</code></span></td> <td>Command for manipulating Imunify360 plugin</td></tr> <tr><td><span class="notranslate"><code>register</code></span></td> <td>Agent registration</td></tr> <tr><td><span class="notranslate"><code>rstatus</code></span></td> <td>Query the server to check if the license is valid</td></tr> <tr><td><span class="notranslate"><code>rules</code></span></td> <td>Allows user to manage disabled rules</td></tr> <tr><td><span class="notranslate"><code>unregister</code></span></td> <td>Unregistration the agent</td></tr> <tr><td><span class="notranslate"><code>vendors</code></span></td> <td>Command for manipulating Imunify360 vendors</td></tr> <tr><td><span class="notranslate"><code>version</code></span></td> <td>Show version</td></tr> <tr><td><span class="notranslate"><code>whitelist</code></span></td> <td>Return/Edit operator for IP and domain white list</td></tr> <tr><td><span class="notranslate"><code>proactive</code></span><sup>3.7.0+</sup></td> <td>Allows to manage Proactive Defense feature</td></tr> <tr><td><span class="notranslate"><code>check modsec directives</code></span><sup> Beta 3.9.0+ cPanel</sup></td> <td>Allows to check whether the global ModSecurity<br>directives have values recommended by Imunify360</td></tr> <tr><td><span class="notranslate"><code>fix modsec directives</code></span><sup> Beta 3.9.0+ cPanel</sup></td> <td>Fixes the non-recommended values (sets them to ones<br>recommended by Imunify360)</td></tr> <tr><td><span class="notranslate"><code>feature-management</code></span></td> <td>manage Imunify360 features available for users</td></tr> <tr><td><span class="notranslate"><code>feature-management native enable</code><sup> Beta 4.0+ cPanel</sup></span></td> <td>activate the Native Features Management using WHM/cPanel package extensions.</td></tr> <tr><td><span class="notranslate"><code>feature-management native disable</code><sup> Beta 4.0+ cPanel</sup></span></td> <td>deactivate the Native Features Management using WHM/cPanel package extensions and return the original Imunify360 Features Management back.</td></tr></tbody></table> <p>Optional arguments for the commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Shows this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Returns data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--by-country-code [country_code]</code></span></td> <td>Filters output by country code.<br>Requires valid country code as argument.<br> Find valid country codes <a href="https://www.nationsonline.org/oneworld/country_code_list.htm" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in column ISO ALPHA-2 CODE.</td></tr> <tr><td><span class="notranslate"><code>--by-ip [ip_address]</code></span></td> <td>Filters output by abuser's IP or by subnet in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.<br>Example: <span class="notranslate"><code>--by-ip 1.2.3.0/24</code></span>.</td></tr> <tr><td><span class="notranslate"><code>--by-list</code></span></td> <td>Can be:<br><ul><li><span class="notranslate">any</span></li><li><span class="notranslate">gray (Gray List)</span></li><li><span class="notranslate">white (White List)</span></li><li><span class="notranslate">black (Black List)</span></li></ul>Filters output based on the list type.<br>Example: <span class="notranslate"><code>--by-list black</code></span>.</td></tr> <tr><td><span class="notranslate"><code>--limit</code></span></td> <td>limits the output with specified number of incidents.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><span class="notranslate"><code>--offset</code></span></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><span class="notranslate"><code>--to</code></span></td> <td>Allows to set the end of the period for filter.<br>Format is a timestamp.</td></tr> <tr><td><span class="notranslate"><code>--manual-only</code></span></td> <td>Show only IP’s that have been added manually.</td></tr> <tr><td><span class="notranslate"><code>--no-manual-only</code></span></td> <td>Show IP’s that have been added both automatically<br>and manually.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if<br>option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="_3rdparty"><a href="#_3rdparty" aria-hidden="true" class="header-anchor">#</a> 3rdparty</h2></div> <p>Command for disabling 3rd party IDS (currently they are cPHulk and fail2ban) and make Imunify360 agent the primary IDS.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent 3rdparty [-h]
</code></pre></div></div> <p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>conflicts</code></span></td> <td>Show conflicts with other software</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>List other IDS that might be running concurrently with Imunify360</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message</td></tr></tbody></table> <p></p><div class="notranslate"><p></p> <h2 id="blacklist"><a href="#blacklist" aria-hidden="true" class="header-anchor">#</a> Blacklist</h2></div> <p>This command allows to view or edit actual IPs in the <span class="notranslate">Black List</span>.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blacklist [subject] [command] &lt;value&gt; [--option]
</code></pre></div></div> <p><span class="notranslate"><code>subject</code></span> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>country</code></span></td> <td>Allows to manipulate with countries in the <span class="notranslate">Black List</span></td></tr> <tr><td><span class="notranslate"><code>ip</code></span></td> <td>Allows to manipulate with IPs in the <span class="notranslate">Black List</span></td></tr></tbody></table> <p><span class="notranslate"><code>command</code></span> is a second positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>add</code></span></td> <td>add item(-s) to <span class="notranslate">Black List</span></td></tr> <tr><td><span class="notranslate"><code>delete</code></span></td> <td>remove item(-s) from <span class="notranslate">Black List</span></td></tr> <tr><td><span class="notranslate"><code>move</code></span></td> <td>move item(-s) to <span class="notranslate">Black List</span></td></tr> <tr><td><span class="notranslate"><code>edit</code></span></td> <td>edit comment on item in the <span class="notranslate">Black List</span></td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>list items(-s) in <span class="notranslate">Black List</span></td></tr></tbody></table> <p>Please note that by default <span class="notranslate"><code>list</code></span> command outputs only first 100 items in the list as if it was run as <span class="notranslate"><code>blacklist ip list --limit 100</code></span>.
To check whether specific IP address is in the list, you can run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>blacklist ip list --by-ip 12.34.56.78
</code></pre></div></div> <p>where 12.34.56.78 is that specific IP address.</p> <p><span class="notranslate"><code>value</code></span> is an item to manipulate with. It can be IP itself or a country code (find necessary country codes here in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the column <span class="notranslate">ISO ALPHA-2 CODE</span>).</p> <p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments specified above and one more:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--comment</code></span></td> <td>allows to add comment to the item</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ul><li>The following command adds IP 1.2.3.4 to the <span class="notranslate">Black List</span> with a comment “one bad IP”:</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blacklist ip add 1.2.3.4 --comment “one bad ip”
</code></pre></div></div> <ul><li>The following command returns a list of IPs in the <span class="notranslate">Black List</span> which are from Bolivia:</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blacklist --by-country-code BO
</code></pre></div></div> <div class="notranslate"><h2 id="blocked-ports"><a href="#blocked-ports" aria-hidden="true" class="header-anchor">#</a> Blocked ports</h2></div> <p>This command allows to view or edit ports, IPs, and protocols in the list of blocked ports.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blocked-port [command] &lt;value&gt; [--option]
</code></pre></div></div> <p><span class="notranslate"><code>command</code></span> is a first positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>add</code></span></td> <td>add item(-s) to blocked ports</td></tr> <tr><td><span class="notranslate"><code>delete</code></span></td> <td>remove item(-s) from blocked ports</td></tr> <tr><td><span class="notranslate"><code>edit</code></span></td> <td>edit comment on item in the blocked ports</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>list items(-s) in blocked ports</td></tr></tbody></table> <p><span class="notranslate"><code>value</code></span> is an item to manipulate with. <span class="notranslate"><code>value</code></span> is <code>:</code> separated pair of port number and protocol: <code>5432:tcp</code>, <code>28:udp</code></p> <p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments specified above and some more:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--comment</code></span></td> <td>allows to add comment to the item</td></tr> <tr><td><span class="notranslate"><code>--ips</code></span></td> <td>allows to add IP addresses to ignore list of the<br>blocked port (port won’t be blocked for this IP addresses)</td></tr></tbody></table> <p><strong>Example:</strong></p> <p>The following command blocks port 5555 for tcp connections with a comment <span class="notranslate">“Some comment”</span>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blocked-port add 5555:tcp --comment “Some comment”
</code></pre></div></div> <div class="notranslate"><h2 id="check-domains"><a href="#check-domains" aria-hidden="true" class="header-anchor">#</a> Check-domains</h2></div> <p>Allows to send domains list to check on Imunify360 central server. This command requires cPanel. After domains checked, the results is available via command <span class="notranslate"><code>infected-domains</code></span>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>The server requires some time for checking and the results may not be ready immediately.</p></div> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent check-domains [--optional arguments]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>show this help message</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>return data in JSON format</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used</td></tr></tbody></table> <div class="notranslate"><h2 id="clean"><a href="#clean" aria-hidden="true" class="header-anchor">#</a> Clean</h2></div> <p>Clean the incident list.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent clean [--optional arguments]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>show this help message</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>return data in JSON format</td></tr> <tr><td><span class="notranslate"><code>--days</code></span></td> <td>cleanups incidents from database, if there are more than specified days quantity<br>Example: <span class="notranslate"><code>--days 5</code></span>.<br>this option will cause deletion of all incidents that are older than 5 days from today</td></tr> <tr><td><span class="notranslate"><code>--limit</code></span></td> <td>leaves only limited number of the incidents in the database and deletes the others<br>Example: <span class="notranslate"><code>--limit 5000</code></span>.<br>this option will leave only 5000 new incidents and delete the others</td></tr></tbody></table> <div class="notranslate"><h2 id="checkdb"><a href="#checkdb" aria-hidden="true" class="header-anchor">#</a> Checkdb</h2></div> <p>Checks database integrity. In case database is corrupt, then this command saves backup copy of the database at <span class="notranslate"><code>/var/imunify360</code></span> and tries to restore integrity of the original database. Note that if this command cannot restore database integrity, then it will destroy the original broken database. Use <span class="notranslate"><code>migratedb</code></span> command to create new clean database.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent checkdb [-h]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="doctor"><a href="#doctor" aria-hidden="true" class="header-anchor">#</a> Doctor</h2></div> <p>Collecting information about Imunify360 state, generating the report and sending it to Imunify360 Support Team. This command can be used in case of any troubles or issues with Imunify360. This command will generate a key to be sent to Imunify360 Support Team. With that key Imunify360 Support Team can help with any problem as fast as possible.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent doctor [-h]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <p></p><div class="notranslate"><p></p> <h2 id="features"><a href="#features" aria-hidden="true" class="header-anchor">#</a> Features</h2></div> <p>Allows to enable or disable additional CloudLinux software included in Imunify360 for free. The following software is available:</p> <ul><li><a href="https://www.kernelcare.com" target="_blank" rel="noopener noreferrer">KernelCare<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><span class="notranslate"><a href="https://www.cloudlinux.com/hardenedphp" target="_blank" rel="noopener noreferrer">HardenedPHP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></li> <li><span class="notranslate">Invisible Captcha</span></li></ul> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features [-h] [command] &lt;feature name&gt;
</code></pre></div></div> <p><span class="notranslate"><code>command</code></span> is a positional arguments and can be :</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>install</code></span></td> <td>allows to enable software</td></tr> <tr><td><span class="notranslate"><code>remove</code></span></td> <td>allows to disable software</td></tr> <tr><td><span class="notranslate"><code>status</code></span></td> <td>allows to check the status of the software</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>allows to list all available software</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>show this help message</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ol><li>The following command checks if KernelCare is installed:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features status kernelcare
</code></pre></div></div> <ol start="2"><li>The following command installs KernelCare:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features install kernelcare
</code></pre></div></div> <ol start="3"><li>The following command uninstalls KernelCare:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features remove kernelcare
</code></pre></div></div> <div class="notranslate"><h2 id="get"><a href="#get" aria-hidden="true" class="header-anchor">#</a> Get</h2></div> <p>The command returns the lists of incidents.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent get [--required argument] [--optional argument]...
</code></pre></div></div> <p>Option can be one or few of the optional arguments listed above and one more.</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--period [period]</code></span></td> <td>Timeframe.<br>Allows to specify the amount of time starting from the current day.<br>Should be greater than (or equal to) 1 minute.<br>Can be specified in format:<ul><li><span class="notranslate"><code>&lt;int&gt;m</code></span> – minutes, example <span class="notranslate"><code>--period 30m</code></span></li><li><span class="notranslate"><code>&lt;int&gt;h</code></span> – hours, example <span class="notranslate"><code>--period 4h</code></span></li><li><span class="notranslate"><code>&lt;int&gt;d</code></span> – days, example <span class="notranslate"><code>--period 7d</code></span></li><li><span class="notranslate"><code>today</code></span> – for today, example <span class="notranslate"><code>--period today</code></span></li><li><span class="notranslate"><code>yesterday</code></span> – for yesterday, example <span class="notranslate"><code>--period yesterday</code></span></li></ul>For example, <span class="notranslate"><code>--period 5d</code></span> will return a list of incidents for 5 days.</td></tr> <tr><td><span class="notranslate"><code>--since [timestamp]</code></span></td> <td>allows to set start time to filter the list of incidents by period</td></tr> <tr><td><span class="notranslate"><code>--to [timestamp]</code></span></td> <td>allows to set finish time to filter the list of incidents by period</td></tr> <tr><td><span class="notranslate"><code>--severity</code></span></td> <td>allows to set severity to filter the list of incidents</td></tr></tbody></table> <p><em>Example:</em></p> <p>The following command shows the incidents (in JSON format) for recent one hour, filtered by country code UA and filtered by Black List IPs:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent get --period 1h --by-country-code UA --by-list black --json
</code></pre></div></div> <div class="notranslate"><h2 id="graylist"><a href="#graylist" aria-hidden="true" class="header-anchor">#</a> Graylist</h2></div> <p>This command allows to view or edit actual IP <span class="notranslate">Black List</span>.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent graylist ip [command] [--optional argument]
</code></pre></div></div> <p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>delete</code></span></td> <td>allows to remove IP from <span class="notranslate">Gray List</span></td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>allows to list IPs in <span class="notranslate">Gray List</span></td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>show this help message</td></tr></tbody></table> <p>Optional arguments for <span class="notranslate"><code>list</code></span>:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--json</code></span></td> <td>Returns data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--by-country-code [country_code]</code></span></td> <td>Filters output by country code.<br>Requires valid country code as argument.<br>Find valid country codes<br>in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in column ISO ALPHA-2 CODE.</td></tr> <tr><td><span class="notranslate"><code>--by-ip [ip_address]</code></span></td> <td>Filters output by abuser's IP or by subnet in CIDR notation.<br>Example: <span class="notranslate"><code>--by-ip 1.2.3.0/24</code></span></td></tr> <tr><td><span class="notranslate"><code>--limit</code></span></td> <td>Limits the output with specified number of IPs.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><span class="notranslate"><code>--offset</code></span></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view<br>if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <p>Please note that by default <span class="notranslate"><code>list</code></span> command outputs only first 100 items in the list as if it was run as <span class="notranslate"><code>graylist ip list --limit 100</code></span>.
To check whether specific IP address is in the list, you can run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>graylist ip list --by-ip 12.34.56.78
</code></pre></div></div> <p>where <code>12.34.56.78</code> is that specific IP address.</p> <p><strong>Example:</strong></p> <p>The following command will remove IP <code>1.2.3.4</code> from the Gray List:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent graylist ip delete 1.2.3.4
</code></pre></div></div> <div class="notranslate"><h2 id="import"><a href="#import" aria-hidden="true" class="header-anchor">#</a> Import</h2></div> <p>This command allows to import <span class="notranslate">Black List</span> and <span class="notranslate">White List</span> from the other 3rd party IDS (only CSF supported at the moment) to Imunify360 database.
Note. If CSF is enabled, then it is not necessary to run the command because Imunify360 is integrated with CSF.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent import [-h] {blocked-ports, wblist} ...
</code></pre></div></div> <p>Positional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>blocked-ports</code></span></td> <td>Import blocked-ports from other IDS</td></tr> <tr><td><span class="notranslate"><code>wblist</code></span></td> <td>Import <span class="notranslate">White/Black List</span> from other IDS</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message</td></tr></tbody></table> <p><strong>Example:</strong></p> <p>The following command will import <span class="notranslate">Black List</span> and <span class="notranslate">White List</span> from the 3rd party IDS:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent import wblist
</code></pre></div></div> <div class="notranslate"><h2 id="infected-domains"><a href="#infected-domains" aria-hidden="true" class="header-anchor">#</a> Infected-domains</h2></div> <p>Allows to retrieve infected domains list.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent infected-domains [-h] [--optional arguments]
</code></pre></div></div> <p>Optional arguments for <span class="notranslate"><code>list</code></span>:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--json</code></span></td> <td>Returns data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--limit</code></span></td> <td>Limits the output with the specified number of domains.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><span class="notranslate"><code>--offset</code></span></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in a good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <p></p><div class="notranslate"><p></p> <h2 id="malware"><a href="#malware" aria-hidden="true" class="header-anchor">#</a> Malware</h2></div> <p>Allows to manage malware options.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent malware [-h] [--optional arguments]
</code></pre></div></div> <p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>dashboard indicators</code></span></td> <td>Show indicators for dashboard.</td></tr> <tr><td><span class="notranslate"><code>ignore</code></span></td> <td>Allows to add, delete or show files which will not be scanned.</td></tr> <tr><td><span class="notranslate"><code>malicious</code></span></td> <td>Allows to manage malicious files.</td></tr> <tr><td><span class="notranslate"><code>on-demand</code></span></td> <td>Allows to manage on-demand scanner.</td></tr> <tr><td><span class="notranslate"><code>read</code></span></td> <td>Allows to read malware files.</td></tr> <tr><td><span class="notranslate"><code>suspicious</code></span></td> <td>Allows to manage suspicious files.</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Returns data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--limit</code></span></td> <td>Limits the output with the specified number of domains.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><span class="notranslate"><code>--offset</code></span></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in a good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr> <tr><td><span class="notranslate"><code>--since SINCE</code></span></td> <td>Start date.</td></tr> <tr><td><span class="notranslate"><code>--to TO</code></span></td> <td>End date.</td></tr> <tr><td><span class="notranslate"><code>--user USER</code></span></td> <td>Returns results for a chosen user.</td></tr></tbody></table> <p><span class="notranslate"><code>command</code></span> is a second positional argument for <span class="notranslate"><code>ignore</code></span> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>add</code></span></td> <td>Add a file or files divided by space to the <span class="notranslate">Ignore List</span>.</td></tr> <tr><td><span class="notranslate"><code>delete</code></span></td> <td>Delete an ignored file or files divided by space from the list.</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>Show a list of ignored files.</td></tr></tbody></table> <p><span class="notranslate"><code>command</code></span> is a second positional argument for <span class="notranslate"><code>malicious</code></span> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>delete</code></span></td> <td>Delete malicious file or files divided by space.</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>Show a list of malicious files.</td></tr> <tr><td><span class="notranslate"><code>move-to-ignore</code></span></td> <td>Move a file or files divided by space to the <span class="notranslate">Ignore List</span>.</td></tr> <tr><td><span class="notranslate"><code>quarantine-malicious</code></span></td> <td>Allows to add malicious files to quarantine.</td></tr> <tr><td><span class="notranslate"><code>restore-from-backup</code></span></td> <td>Restore source files from backup.</td></tr> <tr><td><span class="notranslate"><code>restore-from-quarantine</code></span></td> <td>Restore files from quarantine.</td></tr></tbody></table> <p><span class="notranslate"><code>command</code></span> is a second positional argument for <span class="notranslate"><code>on-demand</code></span> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>start</code></span></td> <td>Start on-demand scanner for the path specified after the <span class="notranslate"><code>start</code></span> command.<br>For example: <span class="notranslate"><code>imunify360-agent malware on-demand start --path /home/&lt;username&gt;/public_html/</code></span></td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>Returns a list of all on-demand scanner session results.</td></tr> <tr><td><span class="notranslate"><code>status</code></span></td> <td>Show current status for on-demand scanner.</td></tr> <tr><td><span class="notranslate"><code>stop</code></span></td> <td>Stop current scanning.</td></tr></tbody></table> <p><span class="notranslate"><code>command</code></span> is a second positional argument for <span class="notranslate"><code>suspicious</code></span> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>delete</code></span></td> <td>Delete suspicious file or files divided by space.</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>Show a list of suspicious files.</td></tr> <tr><td><span class="notranslate"><code>move-to-ignore</code></span></td> <td>Move suspicious files divided by space to the <span class="notranslate">Ignore List</span>.</td></tr> <tr><td><span class="notranslate"><code>move-to-quarantine</code></span></td> <td>Move suspicious files divided by space to the quarantine</td></tr></tbody></table> <p></p><div class="notranslate"><p></p> <h2 id="migratedb"><a href="#migratedb" aria-hidden="true" class="header-anchor">#</a> Migratedb</h2></div> <p>Allows to create clean database if it was corrupted.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Use <span class="notranslate"><code>checkdb</code></span> to check database health.</p></div> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>Imunify360-agent migratedb [-h]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--help, -h</code></span></td> <td>show this help message</td></tr></tbody></table> <div class="notranslate"><h2 id="plugins"><a href="#plugins" aria-hidden="true" class="header-anchor">#</a> Plugins</h2></div> <p>Command for manipulating Imunify360 plugins.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent [command]
</code></pre></div></div> <p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>enable-plugin</code></span></td> <td>Enable Imunify360 plugin.</td></tr> <tr><td><span class="notranslate"><code>disable-plugin</code></span></td> <td>Disable Imunify360 plugin.</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <p></p><div class="notranslate"><p></p> <h2 id="register"><a href="#register" aria-hidden="true" class="header-anchor">#</a> Register</h2></div> <p>Allows to register and activate Imunify360. You can use it in case if Imunify360 was not activated during installation process or in case if activation key of the Imunify360 was changed for any reason. If you do not know what is an activation key or have any problem with it then, please, read <a href="/installation/">Installation guide</a> or contact our <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">support team<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent register [--optional arguments] [KEY]
</code></pre></div></div> <p><span class="notranslate"><code>KEY</code></span> is a positional argument:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>KEY</code></span></td> <td>Register with activation key (use <span class="notranslate"><code>IPL</code></span> to register by IP).</td></tr></tbody></table> <p>If you will use this command without the <span class="notranslate"><code>KEY</code></span> argument, then it will try to register and activate current activation key.</p> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <p><strong>Example 1:</strong></p> <p>The following command will register and activate Imunify360 with the provided activation key:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent register IM250sdfkKK245kJHIL
</code></pre></div></div> <p><strong>Example 2:</strong></p> <p>If you have an IP-based license, you can use <span class="notranslate"><code>IPL</code></span> argument to register and activate Imunify360:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent register IPL
</code></pre></div></div> <div class="notranslate"><h2 id="rstatus"><a href="#rstatus" aria-hidden="true" class="header-anchor">#</a> Rstatus</h2></div> <p>Allows to check if Imunify360 server license is valid.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rstatus [--optional arguments]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>-json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="rules"><a href="#rules" aria-hidden="true" class="header-anchor">#</a> Rules</h2></div> <p>This command allows user to manage rules disabled for firewall plugins Imunify360 uses.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules [command] [--option] &lt;value&gt; [--option] &lt;value&gt;
</code></pre></div></div> <p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>disable</code></span></td> <td>Add a new rule to the disabled rules list.</td></tr> <tr><td><span class="notranslate"><code>enable</code></span></td> <td>Remove a rule from the disabled rules list.</td></tr> <tr><td><span class="notranslate"><code>list-disabled</code></span></td> <td>Display the list of the disabled rules.</td></tr></tbody></table> <p>Option can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--id</code></span></td> <td>ID number of the rule provided by the firewall plugin.</td></tr> <tr><td><span class="notranslate"><code>--plugin</code></span></td> <td>Firewall plugin name. Can be one of the following:<ul><li><span class="notranslate"><code>modsec</code></span> for ModSecurity</li><li><span class="notranslate"><code>ossec</code></span> for OSSEC</li></ul></td></tr> <tr><td><span class="notranslate"><code>--name</code></span></td> <td>Name of the added rule or details of the rule from <span class="notranslate">ModSecurity</span> or OSSEC.</td></tr></tbody></table> <p><strong>Examples</strong></p> <ol><li>The following command adds a rule with id 42 and name <span class="notranslate">‘Rule name’</span> for the <span class="notranslate">ModSecurity</span> rules to the disabled rules list:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules disable --id 42 --plugin modsec --name 'Rule name'
</code></pre></div></div> <ol start="2"><li>The following command removes a rule with id 42 for the ModSecurity rules from the disabled rules list:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules enable --id 42 --plugin modsec
</code></pre></div></div> <ol start="3"><li>The following command displays the list of disabled rules:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules list-disabled
</code></pre></div></div> <p>The list is displayed as follows:</p> <div class="notranslate"><div class="language-Python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'modsec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'214920'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'captchatest.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Imported from config'</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'modsec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'42'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Rule name'</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'ossec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'1003'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Imported from config'</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'ossec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'2502'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'User missed the password more than one time'</span><span class="token punctuation">}</span>
</code></pre></div></div> <p>Where</p> <ul><li><span class="notranslate">plugin</span> — is a firewall plugin name (modsec for <span class="notranslate">ModSecurity</span> and ossec for OSSEC)</li> <li>id — is id number of the rule provided by the firewall plugin</li> <li><span class="notranslate">domains</span> — the list of the domains for which the rule is disabled (None means all domains)*</li> <li><span class="notranslate">name</span> — rule description or details of the rule from ModSecurity or OSSEC</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Domains are specified only for <span class="notranslate">ModSecurity</span> rules. For OSSEC rules it is always applies to all domains.</p></div> <p></p><div class="notranslate"><p></p> <h2 id="unregister"><a href="#unregister" aria-hidden="true" class="header-anchor">#</a> Unregister</h2></div> <p>Allows to unregister and disable Imunify360 on the server.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>To remove Imunify360 from the server it needs to be <a href="/uninstall/">uninstalled</a>.</p></div> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent unregister [--optional arguments]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="vendors"><a href="#vendors" aria-hidden="true" class="header-anchor">#</a> Vendors</h2></div> <p>Command for manipulating Imunify360 vendors.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent [command]
</code></pre></div></div> <p><span class="notranslate"><code>command</code></span> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>install-vendors</code></span></td> <td>Install ModSecurity vendors.<br>This command will install Imunify360 vendor and<br><a href="https://modsecurity.comodo.com/" target="_blank" rel="noopener noreferrer">Comodo WAF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> if there are no conflicts with other installed vendors.</td></tr> <tr><td><span class="notranslate"><code>uninstall-vendors</code></span></td> <td>uninstall <span class="notranslate">ModSecurity</span> vendors.</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="version"><a href="#version" aria-hidden="true" class="header-anchor">#</a> Version</h2></div> <p>Allows to view the actual Imunify360 version installed on the server.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent version [-h] [--json]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="submit-false-positive-false-negative"><a href="#submit-false-positive-false-negative" aria-hidden="true" class="header-anchor">#</a> Submit false-positive/false-negative</h2></div> <p>To submit file as false positive (if Imunify360 considers file as a malicious but it actually doesn’t) you can use the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent submit false-positive &lt;file&gt;
</code></pre></div></div> <p>To submit file as false negative (if Imunify360 considers file as a non-malicious but it actually does) you can use the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent submit false-negative &lt;file&gt;
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--to</code></span></td> <td>Email to send.</td></tr> <tr><td><span class="notranslate"><code>--sender</code></span></td> <td>User email.</td></tr> <tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <p></p><div class="notranslate"><p></p> <h2 id="whitelist"><a href="#whitelist" aria-hidden="true" class="header-anchor">#</a> Whitelist</h2></div> <p>This command allows to view or edit actual IPs and domains in the <span class="notranslate">White List</span>.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist [subject] [command] &lt;value&gt; [--option]
</code></pre></div></div> <p><span class="notranslate"><code>subject</code></span> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>ip</code></span></td> <td>Allows to manipulate with IPs in the <span class="notranslate">White List</span>.</td></tr> <tr><td><span class="notranslate"><code>domain</code></span></td> <td>Allows to manipulate with domains in the <span class="notranslate">White List</span>.</td></tr></tbody></table> <p><span class="notranslate"><code>command</code></span> is a second positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>add</code></span></td> <td>Add item(-s) to the <span class="notranslate">White List</span>.</td></tr> <tr><td><span class="notranslate"><code>delete</code></span></td> <td>Remove item(-s) from the <span class="notranslate">White List.</span></td></tr> <tr><td><span class="notranslate"><code>move</code></span></td> <td>Move item(-s) to the <span class="notranslate">White List</span>.</td></tr> <tr><td><span class="notranslate"><code>edit</code></span></td> <td>Edit comment on the item in the <span class="notranslate">White List</span>.</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>List items(-s) in the <span class="notranslate">White List</span>.</td></tr></tbody></table> <p>Please note that by default <span class="notranslate"><code>list</code></span> command outputs only first 100 items in the list as if it was run as <span class="notranslate"><code>whitelist ip list --limit 100</code></span>.
To check whether specific IP address is in the list, you can run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>whitelist ip list --by-ip 12.34.56.78
</code></pre></div></div> <p>where <code>12.34.56.78</code> is that specific IP address.</p> <p><span class="notranslate"><code>value</code></span> is an item to manipulate with. It can be IP itself or a country code (find the necessary country codes in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in ISO ALPHA-2 CODE column), or a domain name.</p> <p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments from the table above and one more:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--comment</code></span></td> <td>Allows to add a comment to the item.</td></tr> <tr><td><span class="notranslate"><code>--full-access</code></span></td> <td>Only for <span class="notranslate"><code>move</code></span> and <span class="notranslate"><code>edit</code></span> commands.<br>Allows to grant full access to the IP or subnet ignoring the rules in Blocked ports.</td></tr> <tr><td><span class="notranslate"><code>--no-full-access</code></span></td> <td>Only for <span class="notranslate"><code>move</code></span> and <span class="notranslate"><code>edit</code></span> commands.<br>Allows to remove full access of the IP or subnet.</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ol><li>The following commands adds IP <code>1.2.3.4</code> to the <span class="notranslate">White List</span> with a comment <span class="notranslate">“one bad ip”</span>:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist ip add 1.2.3.4 --comment “one good ip”
</code></pre></div></div> <ol start="2"><li>The following command returns a list of IPs in the <span class="notranslate">White List</span> which are from Bolivia:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist --by-country-code BO
</code></pre></div></div> <ol start="3"><li>The following command adds domain with a name <span class="notranslate"><code>example.com</code></span> to the White List:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist domain add example.com
</code></pre></div></div> <ol start="4"><li>The following command checks domains in the <span class="notranslate">White List</span>:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist domain list
</code></pre></div></div> <div class="notranslate"><h2 id="proactive"><a href="#proactive" aria-hidden="true" class="header-anchor">#</a> Proactive</h2></div> <p>These commands allow to manage <span class="notranslate">Proactive Defense</span> feature.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent proactive [command] [--option] &lt;value&gt;
</code></pre></div></div> <p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>ignore delete path</code></span></td> <td>allows to remove a file from <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr> <tr><td><span class="notranslate"><code>ignore delete rule</code></span></td> <td>allows to remove a rule for a file from <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>allows to list <span class="notranslate">Proactive Defense</span> events.</td></tr> <tr><td><span class="notranslate"><code>details</code></span></td> <td>allows to show details for the event.</td></tr> <tr><td><span class="notranslate"><code>ignore list</code></span></td> <td>allows to list files included to <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr> <tr><td><span class="notranslate"><code>ignore add</code></span></td> <td>allows to add a file to <span class="notranslate">Proactive Defense Ignore List</span>.</td></tr></tbody></table> <p><span class="notranslate"><code>option</code></span> can be one or few of the optional arguments listed above and one more.</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--path</code></span></td> <td>for <span class="notranslate"><code>ignore add</code></span>, <span class="notranslate"><code>ignore delete path</code></span>, <span class="notranslate"><code>ignore delete rule</code></span> commands.<br>Allows to specify a path to the file.</td></tr> <tr><td><span class="notranslate"><code>--id</code></span></td> <td>for <span class="notranslate"><code>details</code></span>, <span class="notranslate"><code>ignore delete rule</code></span> commands.<br>Allows to specify rule id.</td></tr> <tr><td><span class="notranslate"><code>--rule-id</code></span></td> <td>only for <span class="notranslate"><code>ignore add</code></span> command.<br>Allows to specify rule id.</td></tr> <tr><td><span class="notranslate"><code>--rule-name</code></span></td> <td>only for <span class="notranslate"><code>ignore add</code></span> command.<br>Allows to specify rule name.</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ol><li>This command adds a file located at <span class="notranslate"><code>/home/user/index.php</code></span> to <span class="notranslate">Proactive Defense Ignore List</span> for the rule id 12 and name <span class="notranslate"><code>Suspicious detection rule</code></span>.
It means that <span class="notranslate">Proactive Defense</span> will not analyze this file according to this rule:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent proactive ignore add --path /home/user/index.php --rule-id 12 --rule-name 'Suspicious detection rule'
</code></pre></div></div> <ol start="2"><li>This command removes files located at <span class="notranslate"><code>&lt;path to file 1&gt;</code></span> and <span class="notranslate"><code>&lt;path to file 2&gt;</code></span> from <span class="notranslate">Proactive Defense Ignore List</span>:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent proactive ignore delete path &lt;path to file 1&gt; &lt;path to file 2&gt;
</code></pre></div></div> <div class="notranslate"><h2 id="check-modsec-directives"><a href="#check-modsec-directives" aria-hidden="true" class="header-anchor">#</a> Check modsec directives</h2></div> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Beta Imunify360 version 3.9.0+ cPanel only</p></div> <p>Allows to check whether the global <a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#Configuration_Directives" target="_blank" rel="noopener noreferrer">ModSecurity directives<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> have values recommended by Imunify360.</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent check modsec directives [--optional arguments]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="fix-modsec-directives"><a href="#fix-modsec-directives" aria-hidden="true" class="header-anchor">#</a> Fix modsec directives</h2></div> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Beta Imunify360 version 3.9.0+ cPanel only</p></div> <p>Fixes the non-recommended values (sets them to ones recommended by Imunify360)</p> <p>Usage:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent fix modsec directives [--optional arguments]
</code></pre></div></div> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Show this help message.</td></tr> <tr><td><span class="notranslate"><code>--json</code></span></td> <td>Return data in JSON format.</td></tr> <tr><td><span class="notranslate"><code>--verbose, -v</code></span></td> <td>Allows to return data in good-looking view if option <span class="notranslate"><code>--json</code></span> is used.</td></tr></tbody></table> <div class="notranslate"><h2 id="feature-management"><a href="#feature-management" aria-hidden="true" class="header-anchor">#</a> Feature-management</h2></div> <p>Allows to manage Imunify360 features available for users.</p> <p><strong>Usage:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent feature-management [command] [--optional argument]...
</code></pre></div></div> <p><span class="notranslate"><code>Command</code></span> can be one of the following:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>defaults</code></span></td> <td>show the default value for each feature that is applied for newly created user</td></tr> <tr><td><span class="notranslate"><code>disable</code></span></td> <td>disable a feature for some or all users</td></tr> <tr><td><span class="notranslate"><code>enable</code></span></td> <td>enable a feature for some or all users</td></tr> <tr><td><span class="notranslate"><code>get</code></span></td> <td>obtains the status of all available features for a <span class="notranslate"><code>USER</code></span></td></tr> <tr><td><span class="notranslate"><code>list</code></span></td> <td>list all available features</td></tr></tbody></table> <p><span class="notranslate"><code>Optional argument</code></span> for the <span class="notranslate"><code>enable/disable</code></span> commands can be one of the following:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>[--feature av]</code></span></td> <td>enable/disable <span class="notranslate">Malware Cleanup</span></td></tr> <tr><td><span class="notranslate"><code>[--feature proactive]</code></span></td> <td>enable/disable <span class="notranslate">Proactive Defense</span></td></tr> <tr><td><span class="notranslate"><code>[--users [USERS [USERS ...]]]</code></span></td> <td>specifies the list of users which will be affected, otherwise the default value will be changed</td></tr></tbody></table> <p>The mandatory argument for the <span class="notranslate"><code>get</code></span> command:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>[--user USER]</code></span></td> <td>specifies a user name to obtain the status of features for</td></tr></tbody></table> <p><strong>Example:</strong></p> <p>The following command enables <span class="notranslate">Malware Cleanup</span> feature for the <span class="notranslate"><code>user1</code></span>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent feature-management enable --feature av --users user1
</code></pre></div></div> <div class="notranslate"><h2 id="feature-management-native-enable"><a href="#feature-management-native-enable" aria-hidden="true" class="header-anchor">#</a> Feature-management native enable</h2></div> <p>Allows to activate the <span class="notranslate">Native Features Management</span> using WHM/cPanel package extensions.</p> <p><strong>Usage:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent feature-management native enable
</code></pre></div></div> <p>Once the command executed, the following default Imunify360 <span class="notranslate">Package Extension</span> settings will be applied to all Packages:</p> <ul><li><span class="notranslate">Malware Scanner - View Reports Only</span></li> <li><span class="notranslate">Proactive Defense - Available</span></li></ul> <p>Imunify360 <span class="notranslate">Package Extensions</span> will be auto-enabled for all packages disregarding the fact they have Imunify360 plugin enabled or not.</p> <p>All existing <span class="notranslate">Features Management</span> settings will be overridden with the Imunify360 <span class="notranslate">Package Extensions</span> ones for all users.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p><span class="notranslate">Features Management</span> tab will be hidden on the User Interface.</p></div> <div class="warning custom-block"><p class="custom-block-title">Warning</p> <p><span class="notranslate"><code>feature-management enable/disable --feature av</code></span> and <span class="notranslate"><code>feature-management enable/disable --feature proactive</code></span> commands will stop functioning.</p></div> <div class="notranslate"><h2 id="feature-management-native-disable"><a href="#feature-management-native-disable" aria-hidden="true" class="header-anchor">#</a> Feature-management native disable</h2></div> <p>Allows to deactivate the <span class="notranslate">Native Features Management</span> using WHM/cPanel package extensions and return the original Imunify360 <span class="notranslate">Features Management</span> back.</p> <p><strong>Usage:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent feature-management native disable
</code></pre></div></div> <p>Once the command executed:</p> <ul><li>The <span class="notranslate">Native Features Management</span> will be deactivated</li> <li>The Imunify360 <span class="notranslate">Package Extensions</span> will be removed from all packages</li> <li>The original Imunify360 <span class="notranslate">Features Management</span> will be activated</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Imunify360 will keep applying users <span class="notranslate">Features Management</span> settings stored in their data bases after switching to the original Imunify360 <span class="notranslate">Features Management</span>.</p></div> <div class="warning custom-block"><p class="custom-block-title">Warning</p> <p><span class="notranslate"><code>feature-management enable/disable --feature av</code></span> and <span class="notranslate"><code>feature-management enable/disable --feature proactive</code></span> commands will start functioning.</p></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/command_line_interface/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> </div> <div class="footer" data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.com" data-v-20b89de8><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-20b89de8></a></div> <div class="footer-company-title" data-v-20b89de8>2019. CloudLinux Inc</div> <div data-v-20b89de8><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/sections/115001344329-How-do-I" target="_blank" data-v-20b89de8>How to</a></div><div data-v-20b89de8><a href="https://imunify360.com/getting-started" target="_blank" data-v-20b89de8>Getting started</a></div><div data-v-20b89de8><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-20b89de8>Contact support</a></div><div data-v-20b89de8><a href="https://www.imunify360.com/blog" target="_blank" data-v-20b89de8>Blog</a></div></div> <div class="social" data-v-20b89de8><span class="footer-social-text" data-v-20b89de8>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-20b89de8><img src="/fb.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-20b89de8><img src="/tw.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-20b89de8><img src="/in.png" class="footer-social-logo" data-v-20b89de8></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-20b89de8><img src="/ytube.png" class="footer-social-logo" data-v-20b89de8></a></div></div> <!----></div></div>
    <script src="/assets/js/app.bb2f7be1.js" defer></script><script src="/assets/js/7.65392d0f.js" defer></script>
  </body>
</html>
